# Instalar Snort
sudo apt update
sudo apt install -y snort

# (Opcional) ver tu interfaz para usarla más abajo (ens33/enp0s3, etc.)
ip -o link show | awk -F': ' '{print $2}'

# Asegurar que se carguen las reglas locales
sudo nano /etc/snort/snort.conf
# Busca esta línea y quítale el '#':
# include $RULE_PATH/local.rules
# (Guarda y sal)

# Reglas locales (una sola edición)
sudo nano /etc/snort/rules/local.rules
# Pega:
alert icmp any any -> any any (msg:"ICMP hacia el host detectado"; sid:1000001; rev:1; threshold:type both,track by_src,count 1,seconds 60;)
alert tcp any any -> any 21 (msg:"Tráfico TCP al puerto 21 detectado"; sid:1000002; rev:1;)
alert tcp any any -> any 22 (msg:"Tráfico TCP al puerto 22 detectado"; sid:1000003; rev:1;)
alert tcp any any -> any 80 (msg:"Tráfico TCP al puerto 80 detectado"; sid:1000004; rev:1;)
# (Guarda y sal)

# Probar sintaxis
sudo snort -T -c /etc/snort/snort.conf

# Correr Snort en consola (cambia INTERFAZ por la tuya: ens33/enp0s3)
sudo snort -A console -q -i INTERFAZ -c /etc/snort/snort.conf

#PRUEBA DESDE OTRA MAQUINA
ping 10.0.0.200         # alerta ICMP
ssh user@10.0.0.200     # alerta 22/tcp
ftp 10.0.0.200          # alerta 21/tcp
curl http://10.0.0.200  # alerta 80/tcp (si hay web)
